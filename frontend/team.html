<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShareAzure - Gestion d'equipe</title>
    <link rel="stylesheet" href="css/team.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <svg class="sidebar-logo" viewBox="0 0 559 165" xmlns="http://www.w3.org/2000/svg">
                <g fill-rule="evenodd">
                    <path d="M58.5905 90.33H89.6405C74.3705 56.31 40.2205 34.02 0.560547 34.02V102.78C0.560547 117.89 12.9605 130.43 28.2105 129.97H65.9906C61.0006 120.61 58.5905 109.53 58.5905 97.79V90.33Z" fill="#639E30"/>
                    <path d="M133.171 164.02C96.971 164.02 68.041 135.72 68.041 99.8H105.101C120.491 99.8 133.181 112.34 133.181 127.88V164.02H133.171Z" fill="#F8AA36"/>
                </g>
            </svg>
            <p class="sidebar-subtitle">Gestion d'equipe</p>
        </div>

        <!-- Team Selector (shown if user has multiple teams) -->
        <div class="team-selector" id="teamSelector" style="display: none;">
            <select id="teamSelect" class="team-select">
            </select>
        </div>

        <nav class="sidebar-nav">
            <a href="#team-dashboard" class="nav-item active" data-section="team-dashboard">
                <i class="fas fa-chart-line nav-icon"></i>
                <span class="nav-text">Tableau de bord</span>
            </a>
            <a href="#my-files" class="nav-item" data-section="my-files">
                <i class="fas fa-folder nav-icon"></i>
                <span class="nav-text">Mes Fichiers</span>
            </a>
            <a href="#team-files" class="nav-item" data-section="team-files">
                <i class="fas fa-folder-open nav-icon"></i>
                <span class="nav-text">Fichiers d'equipe</span>
            </a>
            <a href="#members" class="nav-item" data-section="members">
                <i class="fas fa-users nav-icon"></i>
                <span class="nav-text">Membres</span>
            </a>
            <a href="#team-guests" class="nav-item" data-section="team-guests">
                <i class="fas fa-user-clock nav-icon"></i>
                <span class="nav-text">Invites</span>
            </a>
            <a href="#team-settings" class="nav-item" data-section="team-settings">
                <i class="fas fa-cog nav-icon"></i>
                <span class="nav-text">Parametres</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="btn btn-secondary btn-small btn-block" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i>
                Deconnexion
            </button>
            <p class="version">v3.0.0</p>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Header -->
        <header class="top-header">
            <div class="header-left">
                <h2 id="pageTitle">Tableau de bord</h2>
                <p id="pageSubtitle">Vue d'ensemble de l'equipe</p>
            </div>
            <div class="header-right">
                <button class="btn btn-icon" id="refreshBtn" title="Rafraichir">
                    <i class="fas fa-sync-alt"></i>
                </button>
                <div class="user-menu">
                    <img src="https://ui-avatars.com/api/?name=User&background=003C61&color=fff" alt="User" class="user-avatar">
                    <span class="user-name" id="currentUserName">Utilisateur</span>
                </div>
            </div>
        </header>

        <!-- Team Dashboard Section -->
        <section id="team-dashboard" class="content-section active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon stat-icon-blue">
                        <i class="fas fa-folder-open"></i>
                    </div>
                    <div class="stat-content">
                        <p class="stat-label">Fichiers d'equipe</p>
                        <h3 class="stat-value" id="statTeamFiles">0</h3>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon stat-icon-green">
                        <i class="fas fa-database"></i>
                    </div>
                    <div class="stat-content">
                        <p class="stat-label">Stockage utilise</p>
                        <h3 class="stat-value" id="statTeamStorage">0 B</h3>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon stat-icon-orange">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-content">
                        <p class="stat-label">Membres</p>
                        <h3 class="stat-value" id="statTeamMembers">0</h3>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon stat-icon-red">
                        <i class="fas fa-folder"></i>
                    </div>
                    <div class="stat-content">
                        <p class="stat-label">Mes fichiers</p>
                        <h3 class="stat-value" id="statMyFiles">0</h3>
                    </div>
                </div>
            </div>

            <div class="info-card">
                <h3><i class="fas fa-info-circle"></i> Equipe: <span id="dashboardTeamName">-</span></h3>
                <p id="dashboardTeamDescription" style="color: var(--text-secondary); margin-top: 8px;">-</p>
                <div class="team-meta" style="margin-top: 12px; display: flex; gap: 20px;">
                    <span><i class="fas fa-calendar"></i> Creee le: <span id="dashboardTeamCreated">-</span></span>
                    <span><i class="fas fa-user-shield"></i> Votre role: <span id="dashboardUserRole">-</span></span>
                </div>
            </div>
        </section>

        <!-- My Files Section -->
        <section id="my-files" class="content-section">
            <div class="section-toolbar">
                <div class="search-box">
                    <input type="text" id="myFilesSearch" placeholder="Rechercher dans mes fichiers...">
                </div>
                <div class="toolbar-actions">
                    <button class="btn btn-primary" id="uploadMyFileBtn">
                        <i class="fas fa-cloud-upload-alt"></i> Uploader
                    </button>
                </div>
            </div>
            <div class="table-container">
                <table class="data-table" id="myFilesTable">
                    <thead>
                        <tr>
                            <th>Nom</th>
                            <th>Type</th>
                            <th>Taille</th>
                            <th>Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="myFilesTableBody">
                        <tr><td colspan="5" class="loading">Chargement...</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Team Files Section -->
        <section id="team-files" class="content-section">
            <div class="section-toolbar">
                <div class="search-box">
                    <input type="text" id="teamFilesSearch" placeholder="Rechercher dans les fichiers d'equipe...">
                </div>
                <div class="toolbar-actions">
                    <button class="btn btn-primary" id="uploadTeamFileBtn">
                        <i class="fas fa-cloud-upload-alt"></i> Uploader
                    </button>
                </div>
            </div>
            <div class="table-container">
                <table class="data-table" id="teamFilesTable">
                    <thead>
                        <tr>
                            <th>Nom</th>
                            <th>Type</th>
                            <th>Taille</th>
                            <th>Uploade par</th>
                            <th>Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="teamFilesTableBody">
                        <tr><td colspan="6" class="loading">Chargement...</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Members Section -->
        <section id="members" class="content-section">
            <div class="section-toolbar">
                <h3 style="margin: 0;">Membres de l'equipe</h3>
                <div class="toolbar-actions">
                    <button class="btn btn-primary" id="addMemberBtn">
                        <i class="fas fa-user-plus"></i> Ajouter un membre
                    </button>
                </div>
            </div>
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Nom</th>
                            <th>Username</th>
                            <th>Email</th>
                            <th>Role</th>
                            <th>Rejoint le</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="membersTableBody">
                        <tr><td colspan="6" class="loading">Chargement...</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Guests Section -->
        <section id="team-guests" class="content-section">
            <div class="section-toolbar">
                <h3 style="margin: 0;">Invites de l'equipe</h3>
                <div class="toolbar-actions">
                    <button class="btn btn-primary" id="createGuestBtn">
                        <i class="fas fa-user-plus"></i> Creer un invite
                    </button>
                </div>
            </div>

            <div class="stats-grid" style="margin-bottom: 2rem;">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #0066CC, #003C61); color: white;"><i class="fas fa-users"></i></div>
                    <div class="stat-content">
                        <p class="stat-label">Total invites</p>
                        <h3 class="stat-value" id="guestsTotalCount">0</h3>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #639E30, #4A7523); color: white;"><i class="fas fa-check-circle"></i></div>
                    <div class="stat-content">
                        <p class="stat-label">Actifs</p>
                        <h3 class="stat-value" id="guestsActiveCount">0</h3>
                    </div>
                </div>
            </div>

            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Email</th>
                            <th>Fichiers</th>
                            <th>Cree le</th>
                            <th>Expire le</th>
                            <th>Statut</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="guestsTableBody">
                        <tr><td colspan="6" class="loading">Chargement...</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Team Settings Section -->
        <section id="team-settings" class="content-section">
            <div class="settings-grid">
                <div class="settings-card">
                    <h3><i class="fas fa-info-circle"></i> Informations de l'equipe</h3>
                    <div class="settings-form">
                        <div class="form-group">
                            <label>Nom technique</label>
                            <input type="text" id="settingsTeamName" readonly>
                        </div>
                        <div class="form-group">
                            <label>Nom affiche</label>
                            <input type="text" id="settingsDisplayName">
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="settingsDescription" rows="3"></textarea>
                        </div>
                    </div>
                </div>
            </div>
            <div class="settings-actions">
                <button class="btn btn-primary btn-large" id="saveTeamSettingsBtn">
                    <i class="fas fa-save"></i> Enregistrer
                </button>
            </div>
        </section>
    </main>

    <!-- Add Member Modal -->
    <div class="modal" id="addMemberModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user-plus"></i> Ajouter un membre</h3>
                <button class="btn btn-close" id="closeAddMemberBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Utilisateur *</label>
                    <input type="text" id="memberUsername" placeholder="Nom d'utilisateur">
                </div>
                <div class="form-group">
                    <label>Role</label>
                    <select id="memberRole" class="filter-select" style="width: 100%;">
                        <option value="member">Membre</option>
                        <option value="viewer">Lecteur</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="submitAddMember">
                    <i class="fas fa-plus"></i> Ajouter
                </button>
                <button class="btn btn-secondary" id="cancelAddMemberBtn">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Create Guest Modal -->
    <div class="modal" id="createGuestModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user-plus"></i> Creer un compte invite</h3>
                <button class="btn btn-close" id="closeCreateGuestBtn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="createGuestForm">
                    <div class="form-group">
                        <label><i class="fas fa-envelope"></i> Email de l'invite</label>
                        <input type="email" id="guestEmail" required placeholder="invite@example.com">
                        <small style="color: var(--text-secondary);">Un code de verification sera envoye a cette adresse</small>
                    </div>
                    <div id="createGuestError" class="error-message" style="display: none; margin-top: 1rem; background: #FEE2E2; border: 1px solid #DC2626; border-radius: 8px; padding: 0.75rem;">
                        <i class="fas fa-exclamation-triangle" style="color: #DC2626;"></i>
                        <span id="createGuestErrorMessage"></span>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="submitCreateGuest">
                    <i class="fas fa-paper-plane"></i> Creer et envoyer le code
                </button>
                <button class="btn btn-secondary" id="cancelCreateGuestBtn">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Upload Modal -->
    <div class="modal" id="uploadModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-cloud-upload-alt"></i> Uploader des fichiers</h3>
                <button class="btn btn-close" id="closeUploadBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="upload-zone" id="uploadZone">
                    <i class="fas fa-cloud-upload-alt" style="font-size: 48px; color: var(--primary-color); margin-bottom: 12px;"></i>
                    <p>Glissez-deposez vos fichiers ici</p>
                    <p style="color: var(--text-secondary); font-size: 0.85rem;">ou</p>
                    <input type="file" id="fileInput" multiple hidden>
                    <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
                        Choisir des fichiers
                    </button>
                </div>
                <div class="upload-progress" id="uploadProgress" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <p id="progressText" style="text-align: center; margin-top: 8px;">0%</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirm Modal -->
    <div class="modal" id="confirmModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="confirmTitle">Confirmer</h3>
            </div>
            <div class="modal-body">
                <p id="confirmMessage">Etes-vous sur ?</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" id="confirmYesBtn">Confirmer</button>
                <button class="btn btn-secondary" id="confirmNoBtn">Annuler</button>
            </div>
        </div>
    </div>

    <script src="js/team.js"></script>
</body>
</html>
